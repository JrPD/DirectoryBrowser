@{
	Layout = "../_layout.cshtml";
}

	<div ng-app="myapp" ng-controller="dirCtrl">
		<div>
			<h2>Browse Directories</h2>
			<ul>
				<li ng-repeat="x in directories">
					<!--<a href="{{ x.Id}}"
					> {{x.Name}}</a>-->
					{{x.Name}}

				</li>
			</ul>
		</div>
	</div>
	<script type="text/javascript" src="/Scripts/angular.min.js"></script>

	<script>
	(function() {
		'use strict';


		angular.module('myapp', [])
			.controller('dirCtrl', function($scope) {
				var uri = '/api/directories';
				$scope.directories = [];
				$.getJSON(uri)
					.success(function(response) {
						//alert(response[0].Id + response[0].Name);
						$scope.directories = response.directories;
					})
					.error(function(response) { alert(response) });
			});
		//(function() {
		//	'use strict';
		//	angular
		//		.module("myapp", [])
		//		.controller('dirCtrl', dirs);

		//	function dirs(DirManager) {
		//		$scope.directories = DirManager.directories;
		//	}

		//	dirs.$inject = ['dirManager'];
		//});
	})();


	</script>

	<!--<script src="Scripts/app/dirManager.js"></script>
		<script src="Scripts/app/dirManagerClient.js"></script>-->
	<!--</div>
		<div>
			<h2>All Directories</h2>
			<ul id="directories" style="List-style-type:none;" />
		</div>
		<div>
			<h2>Search by ID</h2>
			<input type="text" id="dirId" size="5" />
			<input type="button" value="Search" onclick="find();" />
			<p id="directory" />
		</div>

	<script src="/Scripts/jquery-2.0.3.min.js"></script>
		<script>
		var uri = 'api/directories';

		$(document).ready(function () {
		  // Send an AJAX request
		  $.getJSON(uri)
			  .done(function (data) {
				// On success, 'data' contains a list of directories.
				FillList(data);
			  });
		});

		function FillData(data) {
			$('<li>')
				.add('<a>', { href: '-1', text: '../' })
				.appendTo($('#directories'));
			FillList(data);
		}

		function FillList(data) {
			$.each(data, function(key, item) {
				// Add a list item for the directory.
				($('<li>').append
					('<a  href="#' + item.Id + '" class="dir" onclick="BrowseDirectory(this)">' + item.Name + '</a>'))
					.appendTo($('#directories'));
			});
		}

		function BrowseDirectory(a) {
			//var id = (a).href.split('/').pop().replace('#', '');
			var id = (a).innerText;
			if (id==="../") {
				id = 0;
			}
			$.getJSON(uri + '/' + id)
				.done(function (data) {
					var myNode = document.getElementById("directories");
					while (myNode.firstChild) {
						myNode.removeChild(myNode.firstChild);
					}
					//('#directories').innerHTML="";
					FillList(data);
				})
				.fail(function (jqXHR, textStatus, err) {
					$('#directory').text('Error: ' + err);
				});
		};

		function formatItem(item) {
		  return item.Id + ':	' + item.Name;
		}

		function find() {
		  var id = $('#dirId').val();
		  $.getJSON(uri + '/' + id)
			  .done(function (data) {
				$('#directory').text(formatItem(data));
			  })
			  .fail(function (jqXHR, textStatus, err) {
				$('#directory').text('Error: ' + err);
			  });
		}
		</script>-->
